# SailOpt â€“ Wingsail Optimal-Angle Prediction

åˆ©ç”¨é€å°æ—¶æ°”è±¡ï¼ˆERA5ï¼‰+ èˆ¹èˆ¶ AIS è½¨è¿¹ï¼Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆLSTM / GRU / TCN / Informerï¼‰é¢„æµ‹ **ç¿¼å½¢é£å¸†** çš„æœ€ä¼˜æ”»è§’ä¸æ¡…æ†ä¿¯ä»°è§’ï¼Œå®ç°èŠ‚æ²¹ä¸å‡æ’ã€‚
## ğŸ“ ç›®å½•ç»“æ„

```plaintext
sail_opt/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ aligned_weather_ship_sail_2022.csv         # å¯¹é½åç¤ºä¾‹ CSV
â”‚   â””â”€â”€ test_aligned_weather_ship_sail.csv         # 48h æµ‹è¯•æ ·æœ¬
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ default.yaml                                # è¶…å‚ä¸è·¯å¾„é…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ dataset.py                                  # æ•°æ®é›†ä¸æ»‘çª—å¤„ç†
â”‚   â”œâ”€â”€ model.py                                    # LSTM/GRU/TCN/Informer ç­‰æ¨¡å‹
â”‚   â”œâ”€â”€ train.py                                    # è®­ç»ƒè„šæœ¬
â”‚   â””â”€â”€ utils.py                                    # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ run_train.py                                    # è®­ç»ƒå…¥å£
â”œâ”€â”€ inference.py                                    # æ¨ç†å…¥å£
â”œâ”€â”€ requirements.txt                                # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md                                       # æœ¬æ–‡ä»¶
```
---

## 1. æ•°æ®é›†æ¦‚è¦

### 1.1 ç‰©ç†æ¥æº  
| æ¨¡å—         | æ•°æ®æº                           | ä½œç”¨                                   |
|--------------|----------------------------------|----------------------------------------|
| **æ°”è±¡åœº**   | Copernicus ERA5 (0.25Â° Ã— 1 h)    | u10 / v10 é£é€Ÿã€æ¸©åº¦ã€æ°”å‹ã€æ³¢æµªç­‰      |
| **èˆ¹èˆ¶è½¨è¿¹** | AIS Vessel Tracks (1 min â†’ 1 h) | çº¬ç»åº¦ã€åœ°é€Ÿ SOGã€èˆªå‘ COGã€èˆ¹è‰ Heading |
| **æ°”åŠ¨æ›²çº¿** | CFD / é£æ´ CLâ€“CD                | ç”Ÿæˆè½¯æ ‡ç­¾ *opt_wing_angle*ã€*opt_mast_pitch* |

### 1.2 è¡¨ç»“æ„ï¼ˆ18 åˆ—ï¼‰  

| #  | å­—æ®µ                | å•ä½      | æè¿°                                |
|----|---------------------|-----------|-------------------------------------|
| 1  | `timestamp`         | â€”         | UTC æ•´ç‚¹æ—¶é—´æˆ³ (`YYYY-MM-DDTHH:00:00Z`) |
| 2  | `latitude` / `longitude` | Â°     | èˆ¹èˆ¶ä½ç½® (WGS-84)                   |
| 3  | `u10`, `v10`        | m/s       | 10 m ä¸œè¥¿ / å—åŒ—é£åˆ†é‡               |
| 4  | `wind_gust`         | m/s       | 10 m é˜µé£æå€¼                       |
| 5  | `t2m`, `d2m`        | K         | 2 m æ°”æ¸© / éœ²ç‚¹                     |
| 6  | `msl`               | Pa        | æµ·å¹³é¢æ°”å‹                          |
| 7  | `tp`                | mm hâ»Â¹    | ä¸Šä¸€å°æ—¶æ€»é™æ°´                      |
| 8  | `ssrd`              | W mâ»Â²     | ä¸‹è¡ŒçŸ­æ³¢è¾å°„                        |
| 9  | `swh`, `wave_dir`   | m / Â°     | æ˜¾è‘—æ³¢é«˜ã€å¹³å‡æ³¢å‘                  |
| 10 | `sog`, `cog`, `heading` | kn / Â° | èˆ¹é€Ÿã€èˆªå‘ã€èˆ¹è‰æŒ‡å‘                |
| 11 | `opt_wing_angle`    | Â°         | CFD è½¯æ ‡ç­¾ï¼šç†è®ºæœ€ä¼˜æ”»è§’            |
| 12 | `opt_mast_pitch`    | Â°         | ç†è®ºæœ€ä¼˜æ¡…æ†ä¿¯ä»°è§’ (`0.2 Ã— angle`)  |

> **ç»´åº¦**  
> - **è¾“å…¥ç‰¹å¾**ï¼š13 åˆ—  
> - **è¾“å‡ºæ ‡ç­¾**ï¼š2 åˆ—  
> - æ¯è¡Œ = æŸèˆ¹ã€æŸæ•´ç‚¹çš„â€œå¤©æ°” + èˆ¹å†µ + æœ€ä¼˜å¸†å§¿â€

### 1.3 å…¸å‹å¼ é‡  
- **åºåˆ—çª—å£**ï¼š`seq_len = 6` â†’ è¿‡å» 6 h  
- **å¼ é‡å½¢çŠ¶**ï¼š`(batch, seq_len, 13)`  
- **æ ‡ç­¾**ï¼š`y = [opt_wing_angle, opt_mast_pitch]` å¯¹åº”çª—å£æœ€åä¸€è¡Œ  
- **æŸå¤±å‡½æ•°**ï¼š`MSELoss()`ï¼ˆÂ°Â²ï¼‰

---

## 2. å¿«é€Ÿä¸Šæ‰‹

```bash
# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python -m venv venv && source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è®­ç»ƒï¼ˆé»˜è®¤ä½¿ç”¨ LSTMï¼‰
python run_train.py

# è¦†ç›–è¶…å‚ç¤ºä¾‹
python run_train.py --model_name gru --learning_rate 5e-4 --batch_size 128
# è®­ç»ƒå®Œæˆåï¼Œæœ€ä¼˜æ¨¡å‹ä¿å­˜åœ¨ checkpoints/best.pt


```
## 3. æ¨¡å‹åˆ‡æ¢

| `--model_name` | ç»“æ„                     | å…¸å‹è¶…å‚                                      |
|----------------|--------------------------|-----------------------------------------------|
| `lstm` (é»˜è®¤)  | åŒå±‚ LSTM + MLP          | `hidden_size=128`                             |
| `gru`          | åŒå±‚ GRU + MLP           | `hidden_size=128`                             |
| `tcn`          | 4Ã— æ®‹å·® TCN              | `hidden_size=64`                              |
| `informer`     | è½»é‡ Transformer Encoder | `hidden_size=128`, `seq_len â‰¥ 24`             |

---

